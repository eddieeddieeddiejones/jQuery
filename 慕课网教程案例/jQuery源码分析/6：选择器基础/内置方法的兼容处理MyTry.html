<!DOCTYPE HTML>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<!-- <script src="http://img.mukewang.com/down/540812440001e40e00000000.js" type="text/javascript"></script>
<script src="http://img.mukewang.com/down/541f6ff70001a0a500000000.js" type="text/javascript"></script> -->

<title></title>
</head>
<body>

<button class="qiao" id="test1">attributes获取class</button>
<button id="test2">attributes检测className</button>
<button id="test3">getElementById检测</button>
<button id="test4">getElementsByTagName检测</button>
<button id="test5">getElementsByClassName检测</button>

<script type="text/javascript" src="../jquery-1.11.2.js"></script>
<!-- <script type="text/javascript" src="../jquery-2.1.1.js"></script> -->
<script type="text/javascript">

  function assert(fn){
    var div = document.createElement("div")
    try{
      return !!fn(div)
    }catch(e){
      console.log("出错了")
      return false
    }finally{
      if(div.parentNode){
        div.parentNode.removeChild(div)
      }else{
        div = null
      }
    }
  }

  $("#test1").click(function(){
    assert(function(div){
      div.className="i"
      // alert(div.getAttrbute("class"))
      // 元素有class属性，但是class是关键字所以平常写className
      alert(div.getAttribute("class"))//i
    })
  })

  $("#test2").click(function(){
    assert(function(div){
      div.className="i"
      alert(div.getAttribute("className"))//null
    })
  })

  $("#test3").click(function(){
    assert(function(div){
      div.id="Aaron"
      document.body.appendChild(div)
      console.log(document.getElementById("Aaron"))
    })
  })

  $("#test4").click(function(){
    assert(function(div){
      //chrome 不支持createComment
      // div.appendChild(document.createComment("a"))
      div.appendChild(document.createElement("div"))
      console.log(div.getElementsByTagName("*"))//[]
    })
  })

  $('#test5').click(function() {
    assert(function(div) {
      div.innerHTML = "<div class='a'></div><div class='a i'></div>";
      // console.log(div)
      div.firstChild.className = "i";
      console.log(div.getElementsByClassName("i").length === 2)//true
    });
  })

  //getElementsByTagName("*")  IE6+
  function getElesByTagName(context,tag){
    var eles=[],
      ele,
      i = 0
    var results = context.getElementsByTagName(tag)
    if(tag === "*"){
      while(ele = results[i++]){
        if(ele.nodeType === 1){
          eles.push(ele)
        }
      }
      return eles
    }
    return results
  }
  // console.log(getElesByTagName(document.body,"button"))

  // getElementsByClassName IE9+
  // function getElesByClassName(className,context){
  function getElesByClassName(name,context){
    var eles =[]
    // if(document.getElementsByClassName){
    //   eles = context.getElementsByClassName(name)
    // } else{
      var temps = context.getElementsByTagName("*")
      for (var i = 0; i < temps.length; i++) {
        if(hasClassName(temps[i],name)){
          eles.push(temps[i])
        }
      };
    // }
    return eles
  }

  function hasClassName(ele,name){
    var classArr = ele.className.split(/\s+/)
    for (var j = 0; j < classArr.length; j++) {
      if(classArr[j] === name){
        return true
      }
    }
    return false
  }
  console.log(getElesByClassName("qiao",document.body))



</script> 

</body>
</html>
